---
title: グローバル変数の移行
description: Analytics 拡張機能の設定から web SDKにグローバル変数を移行する方法を説明します
solution: Data Collection, Analytics
feature: Web SDK
jira: KT-16764
exl-id: 0917e951-c7e0-4723-8354-d308890bdaac
source-git-commit: d01889ca317e29ed0c37b20e17291c4cb5a3abd1
workflow-type: tm+mt
source-wordcount: '609'
ht-degree: 3%

---

# グローバル変数の移行

この演習では、Analytics 拡張機能の設定から web SDKにグローバル変数を移行する方法を説明します。

## 概要

Adobe Analytics拡張機能には、「グローバル変数」という設定セクションがあります。

![ グローバル変数ラベル ](assets/analytics-global-variables-label.jpg)

グローバル変数は、Analytics トラッキングオブジェクトがページ上で初期化されたときに、そのオブジェクトで設定される変数です。ここで設定した変数は、トラッキングオブジェクトが各ページで作成されたときに設定されます。

![ グローバル変数セット ](assets/analytics-set-global-variables.jpg)

変数が設定されている場合は、これらを web SDKにも移行する必要があります。

## Web SDKでグローバル変数を追加する場所

**最後の行** は、Web SDK拡張機能の設定には同等の領域がないので、デフォルトのページ読み込みルールの演習で行ったように、変数をコピーするのと同じくらい簡単ではないということです。
代わりに、簡単に答えると、**すべてのページの他のルールの前に実行される新しいルールを作成し、そこに変数を設定します** です。

手順を定義する必要がない場合は、定義を実行すると、このレッスンは完了です。 ヘルプが必要な場合は、続行してください…

### グローバル変数を Web SDKに移行する手順

1. Adobe Analytics拡張機能の設定を開きます

   ![AA 拡張機能の設定 ](assets/configure-analytics-extension.jpg)

1. 「グローバル変数」セクション（上の画像）までスクロールして開き、設定されている任意の変数またはすべての変数をメモします。 これらの変数と値については、後の手順で知る必要があります。
1. Analytics 拡張機能から取り消します。
1. 左側のナビゲーションで「**ルール**」を選択し、「**ルールを追加**」をクリックします。
1. 新しいルールに「グローバル変数」という名前を付けます。
1. 「イベント」の下の「追加」ボタンをクリックします。

   ![ グローバル変数ルール 1](assets/global-variable-rule-1.jpg)

1. 他のルールの前にトリガーするようにイベントを設定します。 イベントタイプと、他のルールで使用した順序を知っておく必要があります。 値の例：
   1. **拡張機能** をコアに設定
   1. **イベントタイプ** は、実装に応じて DOM Ready にすることができます
   1. **詳細オプション** を展開します。
   1. **順序** を他のルールよりも小さい数に設定して、最初に実行されるようにします。
      ![ グローバル変数イベントの設定 ](assets/configure-global-variable-event.jpg)
      >[!NOTE]
      >
      >ここでの主な理由は、デフォルトのページ読み込みルールの前にこのルールが起動し、このルールで設定されたすべての変数が sendEvent ルールを介して Analytics に送信できるということです。 ただし、Analytics 拡張機能のグローバル変数セクションで設定された変数は他のルールで変更される可能性があるので、このルールが全体として **最初** に実行されることを示唆しています。 私たちはその機能を模倣しています。 上記のサンプルでは、「10」が他のルールよりも低い順序番号であると仮定しています。 それが正しくない場合は、他のルールよりも小さい数値に変更してください。
1. 「**変更を保持**」を選択して作業内容を保存します。
1. このルールに条件を追加する必要はないので、ルール作成のそのセクションはそのままにしておくことができます。
1. 「**アクション** セクションの下にあるプラスアイコンをクリックします
1. 新しいアクションの設定
   1. Adobe Experience Platform Web SDK **Extension** を選択します。
   1. **アクションタイプ** については、「変数を更新」を選択します
   1. 右側で、変数 **データ要素** を選択します（このチュートリアルでは「ページビューデータ要素」と呼ばれていますが、実際の値は異なる場合があります）。
   1. データオブジェクトの下の **Analytics** を選択します
   1. Analytics 拡張機能の設定の「グローバル変数」セクションで保存した変数を入力します（このチュートリアルの例では、data10 をページタイプのeVar要素に設定します）。

   ![websdk-global-variables-action](assets/websdk-global-variables-action.jpg)

1. 変更を保持
1. 作業ライブラリにルールを保存してビルドします

これで、グローバル変数が Web SDKに移行され、任意のページ読み込み時に起動します。
